2025-03-23 21:21:52,342 - DataCollection - INFO - Initializing data collection components...
2025-03-23 21:21:52,344 - simulation.network - INFO - Added device: smartcamera_01 (SmartCamera)
2025-03-23 21:21:52,344 - simulation.network - INFO - Added device: smartlock_02 (SmartLock)
2025-03-23 21:21:52,344 - simulation.network - INFO - Added device: smartthermostat_03 (SmartThermostat)
2025-03-23 21:21:52,346 - DataCollection - INFO - Letting network stabilize for initial baseline...
2025-03-23 21:22:22,350 - DataCollection - INFO - 
Starting normal behavior collection...
2025-03-23 21:22:22,350 - DataCollection - INFO - Collecting normal behavior data for 600 seconds
2025-03-23 21:23:17,450 - DataCollection - INFO - Normal behavior samples collected: 12 (55s)
2025-03-23 21:24:17,561 - DataCollection - INFO - Normal behavior samples collected: 24 (115s)
2025-03-23 21:25:17,660 - DataCollection - INFO - Normal behavior samples collected: 36 (175s)
2025-03-23 21:26:17,771 - DataCollection - INFO - Normal behavior samples collected: 48 (235s)
2025-03-23 21:27:17,877 - DataCollection - INFO - Normal behavior samples collected: 60 (296s)
2025-03-23 21:28:17,982 - DataCollection - INFO - Normal behavior samples collected: 72 (356s)
2025-03-23 21:29:18,078 - DataCollection - INFO - Normal behavior samples collected: 84 (416s)
2025-03-23 21:30:18,175 - DataCollection - INFO - Normal behavior samples collected: 96 (476s)
2025-03-23 21:31:18,290 - DataCollection - INFO - Normal behavior samples collected: 108 (536s)
2025-03-23 21:32:18,394 - DataCollection - INFO - Normal behavior samples collected: 120 (596s)
2025-03-23 21:32:23,403 - DataCollection - INFO - 
Starting attack simulations...
2025-03-23 21:32:23,403 - DataCollection - INFO - 
Simulating botnet attack: Multi-device botnet infection
2025-03-23 21:32:23,403 - DataCollection - INFO - Targets: ['SmartCamera', 'SmartLock']
2025-03-23 21:32:23,404 - DataCollection - INFO - Duration: 180s
2025-03-23 21:32:23,404 - simulation.attack_simulator - INFO - Starting botnet attack scenario targeting ['SmartCamera', 'SmartLock']
2025-03-23 21:32:23,404 - simulation.network - INFO - Updated smartcamera_01 status to infected
2025-03-23 21:32:23,404 - simulation.attack_simulator - INFO - Device smartcamera_01 infected. Total infected: 1
2025-03-23 21:32:28,411 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:32:33,426 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:32:38,433 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:32:43,446 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:32:48,448 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:32:53,462 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:32:58,462 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:03,467 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:08,475 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:33:13,482 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:18,493 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:23,504 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:33:28,514 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:33,515 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:38,525 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:33:43,529 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:48,537 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:33:53,552 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:33:58,560 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:34:03,573 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:34:08,588 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:34:13,603 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:34:18,605 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:34:23,608 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:34:28,615 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:34:33,622 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:34:38,627 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:34:43,640 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:34:48,642 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:34:53,656 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:34:58,662 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:35:03,664 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:35:08,676 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:35:13,685 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:35:18,689 - simulation.attack_simulator - INFO - Attack failed on device smartlock_02
2025-03-23 21:35:23,690 - simulation.attack_simulator - INFO - Attack scenario completed. Generated 36 events
2025-03-23 21:35:23,691 - DataCollection - INFO - 
Attack Event:
  Success: True
  Target: SmartCamera
  Details: {'infection_time': '2025-03-23T21:32:23.404570', 'vulnerabilities_exploited': ['weak_password', 'unencrypted_stream'], 'network_position': 1}
2025-03-23 21:35:23,693 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,694 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,695 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,696 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,697 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,697 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,699 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,699 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,701 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,702 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,704 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,704 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,705 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,706 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,706 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,707 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,708 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,709 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,710 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,711 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,712 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,713 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,714 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,715 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,716 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,717 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,717 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,718 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,719 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,720 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,721 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,721 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,730 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,731 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:35:23,732 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartLock
  Details: {'reason': 'No exploitable vulnerabilities'}
2025-03-23 21:35:23,734 - DataCollection - INFO - Allowing 30s for network recovery...
2025-03-23 21:35:53,745 - DataCollection - INFO - 
Simulating botnet attack: Single device botnet
2025-03-23 21:35:53,745 - DataCollection - INFO - Targets: ['SmartCamera']
2025-03-23 21:35:53,745 - DataCollection - INFO - Duration: 120s
2025-03-23 21:35:53,746 - simulation.attack_simulator - INFO - Starting botnet attack scenario targeting ['SmartCamera']
2025-03-23 21:35:53,746 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:35:58,754 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:03,762 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:08,776 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:13,781 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:18,789 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:23,792 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:28,804 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:33,819 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:38,824 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:43,835 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:48,837 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:53,841 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:36:58,852 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:03,854 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:08,865 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:13,870 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:18,881 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:23,882 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:28,897 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:33,905 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:38,912 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:43,913 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:48,916 - simulation.attack_simulator - INFO - Attack failed on device smartcamera_01
2025-03-23 21:37:53,918 - simulation.attack_simulator - INFO - Attack scenario completed. Generated 24 events
2025-03-23 21:37:53,920 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,921 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,922 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,923 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,924 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,926 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,927 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,928 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,929 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,930 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,931 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,932 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,933 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,935 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,936 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,936 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,937 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,938 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,938 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,939 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,940 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,941 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,942 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,942 - DataCollection - INFO - 
Attack Event:
  Success: False
  Target: SmartCamera
  Details: {'reason': 'Device already infected'}
2025-03-23 21:37:53,943 - DataCollection - INFO - Allowing 24s for network recovery...
2025-03-23 21:38:17,952 - DataCollection - INFO - 
Training initial model with collected data...
2025-03-23 21:38:18,505 - AttackClassifier - INFO - Model saved to models\attack_classifier_20250323_213818.joblib
2025-03-23 21:38:18,505 - AttackClassifier - INFO - Scaler saved to models\feature_scaler_20250323_213818.joblib
2025-03-23 21:38:18,505 - AttackClassifier - INFO - Metadata saved to models\model_metadata_20250323_213818.json
2025-03-23 21:38:18,505 - AttackClassifier - INFO - 
Training Results:
2025-03-23 21:38:18,510 - AttackClassifier - INFO - 
              precision    recall  f1-score   support

      botnet       1.00      1.00      1.00        12
      normal       1.00      1.00      1.00        24

    accuracy                           1.00        36
   macro avg       1.00      1.00      1.00        36
weighted avg       1.00      1.00      1.00        36

2025-03-23 21:38:18,511 - DataCollection - INFO - 
Testing model predictions...
2025-03-23 21:38:18,581 - DataCollection - INFO - Test prediction:
{
  "prediction": "botnet",
  "confidence": 0.9888888888888888,
  "probabilities": {
    "botnet": 0.9888888888888888,
    "normal": 0.01111111111111111
  },
  "detected_signatures": [
    "high_cpu"
  ]
}
2025-03-23 21:38:18,581 - DataCollection - INFO - 
Data collection completed successfully
2025-03-23 21:38:18,581 - DataCollection - INFO - Data collection process finished
