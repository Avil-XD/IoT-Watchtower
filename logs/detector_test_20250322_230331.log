2025-03-22 23:03:31,816 - DetectorTest - INFO - Initializing components...
2025-03-22 23:03:32,989 - AttackDetector - INFO - Loaded model from models\attack_classifier_20250322_230100.joblib
2025-03-22 23:03:32,990 - AttackDetector - INFO - Loaded scaler from models\feature_scaler_20250322_230100.joblib
2025-03-22 23:03:32,991 - IoTSimulation - INFO - Setting up network with 3 devices
2025-03-22 23:03:32,991 - IoTSimulation - INFO - Setting up device: camera_01 (SmartCamera)
2025-03-22 23:03:32,991 - IoTSimulation - INFO - Setting up device: lock_01 (SmartLock)
2025-03-22 23:03:32,991 - IoTSimulation - INFO - Setting up device: thermostat_01 (SmartThermostat)
2025-03-22 23:03:32,991 - IoTSimulation - INFO - Network setup completed successfully
2025-03-22 23:03:33,001 - IoTSimulation - INFO - Starting simulation
2025-03-22 23:03:33,003 - DetectorTest - INFO - Monitoring normal network behavior...
2025-03-22 23:03:33,016 - AttackDetector - WARNING - Attack detected: normal (confidence: 1.000)
2025-03-22 23:03:33,016 - DetectorTest - WARNING - Alert! normal attack detected with 1.000 confidence
2025-03-22 23:03:33,017 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:03:33,017 - DetectorTest - INFO -   Total Detections: 1
2025-03-22 23:03:33,017 - DetectorTest - INFO -   Alerts Triggered: 1
2025-03-22 23:03:33,017 - DetectorTest - INFO -   normal: 1 detections (avg confidence: 1.000)
2025-03-22 23:03:38,030 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.990)
2025-03-22 23:03:38,031 - DetectorTest - WARNING - Alert! normal attack detected with 0.990 confidence
2025-03-22 23:03:38,031 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:03:38,031 - DetectorTest - INFO -   Total Detections: 2
2025-03-22 23:03:38,031 - DetectorTest - INFO -   Alerts Triggered: 2
2025-03-22 23:03:38,031 - DetectorTest - INFO -   normal: 2 detections (avg confidence: 0.995)
2025-03-22 23:03:43,045 - AttackDetector - WARNING - Attack detected: normal (confidence: 1.000)
2025-03-22 23:03:43,045 - DetectorTest - WARNING - Alert! normal attack detected with 1.000 confidence
2025-03-22 23:03:43,046 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:03:43,046 - DetectorTest - INFO -   Total Detections: 3
2025-03-22 23:03:43,046 - DetectorTest - INFO -   Alerts Triggered: 3
2025-03-22 23:03:43,047 - DetectorTest - INFO -   normal: 3 detections (avg confidence: 0.997)
2025-03-22 23:03:48,062 - AttackDetector - WARNING - Attack detected: normal (confidence: 1.000)
2025-03-22 23:03:48,062 - DetectorTest - WARNING - Alert! normal attack detected with 1.000 confidence
2025-03-22 23:03:48,062 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:03:48,062 - DetectorTest - INFO -   Total Detections: 4
2025-03-22 23:03:48,063 - DetectorTest - INFO -   Alerts Triggered: 4
2025-03-22 23:03:48,063 - DetectorTest - INFO -   normal: 4 detections (avg confidence: 0.998)
2025-03-22 23:03:53,079 - AttackDetector - WARNING - Attack detected: normal (confidence: 1.000)
2025-03-22 23:03:53,079 - DetectorTest - WARNING - Alert! normal attack detected with 1.000 confidence
2025-03-22 23:03:53,080 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:03:53,080 - DetectorTest - INFO -   Total Detections: 5
2025-03-22 23:03:53,080 - DetectorTest - INFO -   Alerts Triggered: 5
2025-03-22 23:03:53,081 - DetectorTest - INFO -   normal: 5 detections (avg confidence: 0.998)
2025-03-22 23:03:58,098 - AttackDetector - WARNING - Attack detected: normal (confidence: 1.000)
2025-03-22 23:03:58,098 - DetectorTest - WARNING - Alert! normal attack detected with 1.000 confidence
2025-03-22 23:03:58,098 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:03:58,099 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:03:58,099 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:03:58,099 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.998)
2025-03-22 23:04:03,114 - DetectorTest - INFO - 
Simulating botnet attack...
2025-03-22 23:04:03,114 - AttackSimulator - INFO - Creating botnet attack targeting ['camera_01', 'lock_01']
2025-03-22 23:04:03,115 - AttackSimulator - INFO - Attack botnet_20250322_230403 created
2025-03-22 23:04:03,115 - AttackSimulator - INFO - Launching botnet attack on targets: ['camera_01', 'lock_01']
2025-03-22 23:04:03,115 - AttackSimulator - INFO - Attack 8fd9732a-eef7-4609-b6fb-840669c8b85f launched successfully
2025-03-22 23:04:03,128 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.950)
2025-03-22 23:04:03,128 - DetectorTest - WARNING - Alert! normal attack detected with 0.950 confidence
2025-03-22 23:04:03,129 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:03,129 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:03,129 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:03,129 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.990)
2025-03-22 23:04:08,152 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.870)
2025-03-22 23:04:08,153 - DetectorTest - WARNING - Alert! normal attack detected with 0.870 confidence
2025-03-22 23:04:08,153 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:08,153 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:08,153 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:08,153 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.970)
2025-03-22 23:04:13,167 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.880)
2025-03-22 23:04:13,167 - DetectorTest - WARNING - Alert! normal attack detected with 0.880 confidence
2025-03-22 23:04:13,168 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:13,168 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:13,168 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:13,168 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.950)
2025-03-22 23:04:18,191 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.880)
2025-03-22 23:04:18,192 - DetectorTest - WARNING - Alert! normal attack detected with 0.880 confidence
2025-03-22 23:04:18,192 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:18,192 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:18,193 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:18,193 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.930)
2025-03-22 23:04:23,215 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.860)
2025-03-22 23:04:23,215 - DetectorTest - WARNING - Alert! normal attack detected with 0.860 confidence
2025-03-22 23:04:23,216 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:23,216 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:23,216 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:23,216 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.907)
2025-03-22 23:04:28,242 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.850)
2025-03-22 23:04:28,242 - DetectorTest - WARNING - Alert! normal attack detected with 0.850 confidence
2025-03-22 23:04:28,242 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:28,242 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:28,242 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:28,243 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.882)
2025-03-22 23:04:33,268 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.870)
2025-03-22 23:04:33,268 - DetectorTest - WARNING - Alert! normal attack detected with 0.870 confidence
2025-03-22 23:04:33,268 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:33,269 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:33,269 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:33,269 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.868)
2025-03-22 23:04:38,287 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.870)
2025-03-22 23:04:38,287 - DetectorTest - WARNING - Alert! normal attack detected with 0.870 confidence
2025-03-22 23:04:38,287 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:38,288 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:38,288 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:38,288 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.868)
2025-03-22 23:04:43,302 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.870)
2025-03-22 23:04:43,302 - DetectorTest - WARNING - Alert! normal attack detected with 0.870 confidence
2025-03-22 23:04:43,303 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:43,303 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:43,303 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:43,303 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.867)
2025-03-22 23:04:48,316 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.860)
2025-03-22 23:04:48,316 - DetectorTest - WARNING - Alert! normal attack detected with 0.860 confidence
2025-03-22 23:04:48,317 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:48,317 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:48,317 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:48,317 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.863)
2025-03-22 23:04:53,342 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.880)
2025-03-22 23:04:53,343 - DetectorTest - WARNING - Alert! normal attack detected with 0.880 confidence
2025-03-22 23:04:53,343 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:53,343 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:53,343 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:53,343 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.867)
2025-03-22 23:04:58,356 - AttackDetector - WARNING - Attack detected: normal (confidence: 0.870)
2025-03-22 23:04:58,357 - DetectorTest - WARNING - Alert! normal attack detected with 0.870 confidence
2025-03-22 23:04:58,357 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:04:58,357 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:04:58,357 - DetectorTest - INFO -   Alerts Triggered: 6
2025-03-22 23:04:58,357 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.870)
2025-03-22 23:05:03,363 - DetectorTest - INFO - 
Waiting for network recovery...
2025-03-22 23:05:33,371 - DetectorTest - INFO - 
Simulating DDoS attack...
2025-03-22 23:05:33,371 - AttackSimulator - INFO - Creating DDoS attack targeting ['camera_01']
2025-03-22 23:05:33,372 - AttackSimulator - INFO - Attack ddos_20250322_230533 created
2025-03-22 23:05:33,372 - AttackSimulator - INFO - Launching ddos attack on targets: ['camera_01']
2025-03-22 23:05:33,372 - AttackSimulator - INFO - Attack 1aee4de8-f457-4e38-a6c1-2afd94afb6fe launched successfully
2025-03-22 23:05:33,384 - DetectorTest - INFO - Network status: normal (confidence: 0.610)
2025-03-22 23:05:33,385 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:05:33,385 - DetectorTest - INFO -   Total Detections: 1
2025-03-22 23:05:33,385 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:05:33,386 - DetectorTest - INFO -   normal: 1 detections (avg confidence: 0.610)
2025-03-22 23:05:38,404 - DetectorTest - INFO - Network status: normal (confidence: 0.630)
2025-03-22 23:05:38,404 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:05:38,404 - DetectorTest - INFO -   Total Detections: 2
2025-03-22 23:05:38,404 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:05:38,404 - DetectorTest - INFO -   normal: 2 detections (avg confidence: 0.620)
2025-03-22 23:05:43,426 - DetectorTest - INFO - Network status: normal (confidence: 0.600)
2025-03-22 23:05:43,428 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:05:43,428 - DetectorTest - INFO -   Total Detections: 3
2025-03-22 23:05:43,428 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:05:43,428 - DetectorTest - INFO -   normal: 3 detections (avg confidence: 0.613)
2025-03-22 23:05:48,449 - DetectorTest - INFO - Network status: normal (confidence: 0.630)
2025-03-22 23:05:48,449 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:05:48,450 - DetectorTest - INFO -   Total Detections: 4
2025-03-22 23:05:48,450 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:05:48,450 - DetectorTest - INFO -   normal: 4 detections (avg confidence: 0.617)
2025-03-22 23:05:53,466 - DetectorTest - INFO - Network status: normal (confidence: 0.640)
2025-03-22 23:05:53,466 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:05:53,466 - DetectorTest - INFO -   Total Detections: 5
2025-03-22 23:05:53,466 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:05:53,467 - DetectorTest - INFO -   normal: 5 detections (avg confidence: 0.622)
2025-03-22 23:05:58,494 - DetectorTest - INFO - Network status: normal (confidence: 0.620)
2025-03-22 23:05:58,494 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:05:58,495 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:05:58,495 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:05:58,495 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.622)
2025-03-22 23:06:03,517 - DetectorTest - INFO - Network status: normal (confidence: 0.600)
2025-03-22 23:06:03,519 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:06:03,519 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:06:03,519 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:06:03,519 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.620)
2025-03-22 23:06:08,534 - DetectorTest - INFO - Network status: normal (confidence: 0.630)
2025-03-22 23:06:08,534 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:06:08,534 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:06:08,534 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:06:08,534 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.620)
2025-03-22 23:06:13,553 - DetectorTest - INFO - Network status: normal (confidence: 0.630)
2025-03-22 23:06:13,553 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:06:13,553 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:06:13,553 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:06:13,553 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.625)
2025-03-22 23:06:18,569 - DetectorTest - INFO - Network status: normal (confidence: 0.620)
2025-03-22 23:06:18,569 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:06:18,569 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:06:18,570 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:06:18,570 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.623)
2025-03-22 23:06:23,593 - DetectorTest - INFO - Network status: normal (confidence: 0.640)
2025-03-22 23:06:23,593 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:06:23,593 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:06:23,593 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:06:23,593 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.623)
2025-03-22 23:06:28,608 - DetectorTest - INFO - Network status: normal (confidence: 0.620)
2025-03-22 23:06:28,609 - DetectorTest - INFO - Recent Activity Summary:
2025-03-22 23:06:28,609 - DetectorTest - INFO -   Total Detections: 6
2025-03-22 23:06:28,609 - DetectorTest - INFO -   Alerts Triggered: 0
2025-03-22 23:06:28,609 - DetectorTest - INFO -   normal: 6 detections (avg confidence: 0.623)
2025-03-22 23:06:33,616 - DetectorTest - INFO - 
Final Detection Summary:
2025-03-22 23:06:33,616 - DetectorTest - INFO - Total detections: 30
2025-03-22 23:06:33,616 - DetectorTest - INFO - Total alerts: 18
2025-03-22 23:06:33,617 - DetectorTest - ERROR - Test failed: name 'timestamp' is not defined
2025-03-22 23:06:33,617 - DetectorTest - INFO - Stopping simulation...
2025-03-22 23:06:33,618 - IoTSimulation - INFO - Stopping simulation
2025-03-22 23:06:33,788 - DetectorTest - INFO - Test completed
